# FunMusic 音乐点歌插件

一个功能丰富的音乐点歌插件，支持多种音乐平台，提供音乐卡片和语音播放功能。

## 功能特点

- 支持多个音乐平台
  - 酷狗音乐
  - 网易云音乐
  - 汽水音乐 (抖音/TikTok音乐源)
- 支持随机点歌功能
- 支持音乐卡片分享
- 支持语音播放音乐
- 快捷点歌命令（默认使用酷狗音乐）
- 完善的错误处理和日志记录

## 使用方法

### 点歌功能（发送音乐卡片）

搜索歌曲并发送音乐分享卡片：

1. **酷狗音乐**:
   - 搜索歌曲：`酷狗点歌 歌曲名`
   - 获取音乐卡片：`酷狗点歌 歌曲名 序号`

2. **网易云音乐**:
   - 搜索歌曲：`网易点歌 歌曲名`
   - 获取音乐卡片：`网易点歌 歌曲名 序号`

3. **汽水音乐**:
   - 搜索歌曲：`汽水点歌 歌曲名`
   - 获取音乐卡片：`汽水点歌 歌曲名 序号`

4. **快捷点歌**:
   - 直接发送：`点歌 歌曲名`（默认使用酷狗音乐）

### 听歌功能（语音消息播放）

通过语音消息播放歌曲（需先搜索获取序号）：

- 酷狗音乐：`酷狗听歌 歌曲名 序号`
- 网易云音乐：`网易听歌 歌曲名 序号`
- 汽水音乐：`汽水听歌 歌曲名 序号`

### 随机点歌

发送 `随机点歌` 获取一首随机的热门歌曲分享卡片。

### 帮助命令

发送 `音乐帮助` 或 `点歌帮助` 获取插件使用说明。

## 配置说明

编辑 `config.toml` 文件可以自定义插件行为：

```toml
# 基本设置
[basic]
# 是否启用插件
enabled = true

# API设置
[api]
# 请求超时时间（秒）
timeout = 10
# 是否禁用SSL验证
disable_ssl_verify = true

# 音乐平台设置
[platforms]
# 酷狗音乐
kugou_enabled = true
# 网易云音乐
netease_enabled = true
# 汽水音乐
qishui_enabled = true
# 随机音乐
random_enabled = true
```

## 技术实现

- 使用第三方音乐API获取音乐信息和播放链接
- 支持多平台搜索和播放
- 智能封面获取，自动从多个来源尝试获取歌曲封面
- 优化的语音消息发送，含多种备用方案
- 完善的错误处理和用户反馈机制

## 注意事项

- 语音播放功能受微信API限制，某些音频可能无法正常发送
- 使用汽水音乐时，部分封面图片可能因为域名限制无法在微信中正常显示
- 建议优先使用音乐卡片功能，体验更佳
- 所有音乐资源来自第三方API，不保证永久可用性

## 错误排查

如遇到问题，请检查：

1. 网络连接是否正常
2. API接口是否可用
3. 配置文件中相应平台是否已启用
4. 日志中是否有具体错误信息

## 版本历史

- v4.0.0: 重构插件代码，优化性能，改进错误处理
- v3.0.0: 增加汽水音乐支持
- v2.0.0: 增加网易云音乐和语音播放功能
- v1.0.0: 初始版本，仅支持酷狗音乐

## 作者与版权

作者：Lingyuzhou，由 ChatGPT 辅助优化
版本：4.0.0 